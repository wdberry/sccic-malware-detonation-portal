using System.Text.Json;
using System.Text.Json.Serialization;

namespace sccic_malware_detonation_portal;

public class SubmissionRequest {

    [JsonPropertyName("kind")]
    public Kind Kind { get; set; } = Kind.file;
    [JsonPropertyName("submitter")]
    public string? Submitter { get; set; }
    [JsonPropertyName("password")]
    public string? Password { get; set; }
    [JsonPropertyName("response_requested")]
    public bool ResponseRequested { get; set; }
    [JsonPropertyName("url")]
    public Uri? Url { get; set; }
    [JsonPropertyName("interactive")]
    public bool? Interactive { get; set; } = false;
    [JsonPropertyName("user_tags")]
    public Dictionary<string, string>? UserTags { get; set; }
    [JsonPropertyName("comment")]
    public string? Comment { get; set; }
    [JsonPropertyName("defaults")]
    public Defaults? Defaults { get; set; }


}

public class Defaults {
    public int Timeout { get; set; } = 60;
    public Network Network { get; set; } = Network.internet;
}

public enum Kind {
    file,
    url,
    fetch
}

public enum Network {
    internet,
    drop,
    tor
}